<div align="center">
<img width="1200" height="475" alt="GHBanner" src="https://github.com/user-attachments/assets/0aa67016-6eaf-458a-adb2-6e31a0763ed6" />
</div>

# Run and deploy your AI Studio app

This contains everything you need to run your app locally.

View your app in AI Studio: https://ai.studio/apps/drive/1hf_0EaPimHweIrsoRHXy6rYMutGjitBs

## Run Locally

**Prerequisites:**  Node.js


1. Install dependencies:
   `npm install`
2. Create your env file:
   - Copy `.env.example` to `.env.local`
   - (Optional) Fill in `GEMINI_API_KEY` to enable AI
3. Run the app:
   `npm run dev`
4. (Optional) Type-check:
   `npm run typecheck`

## Database (Supabase, for Guestbook)

The `Guestbook` component supports two modes:
- **Demo mode** (default): stores messages in `localStorage`
- **Realtime mode**: stores/reads messages from Supabase and subscribes to inserts

1. Create a Supabase project (free) at `https://supabase.com`
2. In Supabase, open **SQL Editor** and run:
   - Create table:
     - `create table public.messages ( id bigint generated by default as identity primary key, name text, identity text, content text, province text, created_at timestamptz default now() );`
   - Enable RLS:
     - `alter table public.messages enable row level security;`
   - Policies (public read + public insert):
     - `create policy "public read" on public.messages for select using (true);`
     - `create policy "public insert" on public.messages for insert with check (true);`
3. Enable Realtime for `public.messages` (Database > Replication > toggle table on)
4. In `.env.local`, set:
   - `VITE_SUPABASE_URL` (Project URL)
   - `VITE_SUPABASE_ANON_KEY` (anon public key)

## Deploy

This is a Vite static site. Build output is in `dist/`.

## Deploy (GitHub Pages, standard)

1. Push this repo to GitHub.
2. In GitHub: **Settings → Pages → Build and deployment → Source: GitHub Actions**.
3. (Optional, for global Guestbook) In GitHub: **Settings → Secrets and variables → Actions**, add either as **Variables** or **Secrets**:
   - `VITE_SUPABASE_URL`
   - `VITE_SUPABASE_ANON_KEY` (use the anon/public key, not a service role key)
4. Push to `main` to trigger deploy.

Your site will be available at: `https://<username>.github.io/<repo>/`

## Single HTML (offline / shareable)

If you can't use Vercel (e.g. mainland China), you can export a single self-contained HTML file:

1. Install deps: `npm install`
2. Build: `npm run build:single`
3. Share `dist/silent-scream.html` (receiver can double-click to open)

Note: the AI feature (`/api/gemini`) requires a backend, so it will be disabled in the single-file build unless you provide your own server.
Note: the Guestbook is in **local mode** in `build:single` (messages are stored in the viewer's browser only).

### Single HTML + global Guestbook (Supabase)

If you want the Guestbook to be globally synced via Supabase (still exporting a single HTML file):

1. Configure Supabase env vars in `.env.local`:
   - `VITE_SUPABASE_URL`
   - `VITE_SUPABASE_ANON_KEY`
2. Build: `npm run build:single:online`
3. Share `dist/silent-scream-online.html`

### Option A: Vercel (recommended)

1. Push this repo to GitHub
2. Go to `https://vercel.com/new` and import the repo
3. Set:
   - Build Command: `npm run build`
   - Output Directory: `dist`
4. Add Environment Variables (Project > Settings > Environment Variables):
   - `GEMINI_API_KEY` (optional)
   - `VITE_SUPABASE_URL` (optional)
   - `VITE_SUPABASE_ANON_KEY` (optional)
5. Deploy

### Option B: Netlify

1. Push this repo to GitHub
2. Go to `https://app.netlify.com/start` and import the repo
3. Set:
   - Build command: `npm run build`
   - Publish directory: `dist`
4. Add the same Environment Variables in Site settings > Environment variables

### Option C: Any static host (manual upload)

1. Build locally: `npm run build`
2. Upload the `dist/` folder to your static hosting provider

### Important note about `GEMINI_API_KEY`

This project calls Gemini through a serverless proxy at `/api/gemini` (Vercel Function), so `GEMINI_API_KEY` stays on the server and is not embedded in the frontend bundle.

Local development note: the AI feature requires the `/api/gemini` function, so run with `vercel dev` (after setting `GEMINI_API_KEY`) if you want AI locally.
